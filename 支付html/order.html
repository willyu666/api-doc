<!doctype html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>接口规则</title>
	<link rel="stylesheet" type="text/css" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" href="css/default.css">
	<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="css/styles.css">
</head>
 <style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-tmsl{background-color:#ffffff;border-color:#c0c0c0;text-align:left}
.tg .tg-krjj{font-weight:bold;background-color:#efefef;border-color:#c0c0c0;text-align:left}
.tg .tg-u4qj{background-color:#efefef;border-color:#c0c0c0;text-align:left;vertical-align:top}
.tg .tg-855q{background-color:#ffffff;border-color:#c0c0c0;text-align:left;vertical-align:top}
.tg .tg-xggu{background-color:#efefef;border-color:#c0c0c0;text-align:left}
.tg .tg-wo29{border-color:#c0c0c0;text-align:left;vertical-align:top}
</style>
<body>
	<nav>
	  <ul>
	    <a href="./index.html"> <li>Iotpay接入说明</li></a>	  	    
	    <a href="./codeid.html"><li>编码表</li></a>
		<a href="./interfacerule.html"> <li>接口规则</li></a>
		<a href="./order.html"><li>统一下单</li></a>
		<a href="./errorcode.html"><li>全局错误码</li></a>
		<li>下载</li>
	  </ul>
	</nav>
	<div class="openNav">
	  <div class="icon"></div>
	</div>

	<div class="wrapper">
		<header class="htmleaf-header">
			<h1>统一下单<span>order</span></h1>
			<div class="htmleaf-links">
				<a class="htmleaf-icon icon-htmleaf-home-outline" href="http://www.iotpay.ca" title="Iotpay" target="_blank"><span> Iotpay.ca</span></a>
				<a class="htmleaf-icon icon-htmleaf-arrow-forward-outline" href="./index.html" title="Iotpay接入说明" target="_blank"><span> Iotpay接入说明</span></a>
			</div>
		</header>
	  <section>
	<div class="doc-title-box">
			<h2 style="font-weight: bold;">统一下单</h2>
		</div>
     <p>业务通过统一下单接口可以发起任意三方支付渠道的支付订单。业务系统不必关心该如何调用三方支付，统一下单接口会根据业务系统选择的支付渠道ID，选择对应支付渠道的支付产品，发起下单请求，然后响应给业务系统支付请求所需参数。</p>
	 <p><img src="./imgs/process.png" alt="流程图" style="width:900px;height:700px;"></p>
	 <div class="doc-title-box">
			<h2 style="font-weight: bold;">请求URL</h2>
	 </div>
		<p>服务地址: <pre>https://pay.4jicao.com/api/pay/create_order</pre></p>
		<p>请求方式：</p>
		<p>◆ POST</p>
		<p>◆ Content-Type: application/x-www-form-urlencoded</p>
	 <div class="doc-title-box">
			<h2 style="font-weight: bold;">参数</h2>
	 </div>	
			
		<table class="tg">
		  <tr>
			<th class="tg-krjj">字段名</th>
			<th class="tg-krjj">变量名</th>
			<th class="tg-krjj">必填</th>
			<th class="tg-krjj">类型</th>
			<th class="tg-u4qj">示例值</th>
			<th class="tg-u4qj">描述</th>
		  </tr>
		  <tr>
			<td class="tg-tmsl">商户ID</td>
			<td class="tg-tmsl">mchId</td>
			<td class="tg-tmsl">是</td>
			<td class="tg-tmsl">String(30)</td>
			<td class="tg-855q">20001222</td>
			<td class="tg-855q">支付中心分配的商户号</td>
		  </tr>
		  <tr>
			<td class="tg-xggu">商户订单号</td>
			<td class="tg-xggu">mchOrderNo</td>
			<td class="tg-xggu">是</td>
			<td class="tg-xggu">String(30)</td>
			<td class="tg-wo29">20160427210604000490</td>
			<td class="tg-wo29">商户生成的订单号，请保证唯一性</td>
		  </tr>
		  <tr>
			<td class="tg-tmsl">渠道ID</td>
			<td class="tg-tmsl">channelId</td>
			<td class="tg-tmsl">是</td>
			<td class="tg-tmsl">String(24)</td>
			<td class="tg-855q">WX_JSAPI</td>
			<td class="tg-855q">见支付渠道参数</td>
		  </tr>
		  <tr>
			<td class="tg-xggu">币种</td>
			<td class="tg-xggu">currency</td>
			<td class="tg-xggu">是</td>
			<td class="tg-xggu">String(3)</td>
			<td class="tg-wo29">CAD</td>
			<td class="tg-wo29">三位货币代码,加币:CAD</td>
		  </tr>
		  <tr>
			<td class="tg-tmsl">支付金额</td>
			<td class="tg-tmsl">amount</td>
			<td class="tg-tmsl">是</td>
			<td class="tg-tmsl">int</td>
			<td class="tg-855q">100</td>
			<td class="tg-855q">支付金额,单位分</td>
		  </tr>
		  <tr>
			<td class="tg-xggu">客户端IP</td>
			<td class="tg-xggu">clientIp</td>
			<td class="tg-xggu">是</td>
			<td class="tg-xggu">String(32)</td>
			<td class="tg-wo29">210.73.10.148</td>
			<td class="tg-wo29">客户端IP地址</td>
		  </tr>
		  <tr>
			<td class="tg-tmsl">设备</td>
			<td class="tg-tmsl">device</td>
			<td class="tg-tmsl">否</td>
			<td class="tg-tmsl">String(64)</td>
			<td class="tg-855q">WEB</td>
			<td class="tg-855q">终端设备号(门店号或收银设备ID)，注意：PC网页或公众号内支付请传”WEB</td>
		  </tr>
		  <tr>
			<td class="tg-u4qj">支付结果回调URL</td>
			<td class="tg-u4qj">notifyUrl</td>
			<td class="tg-u4qj">是</td>
			<td class="tg-u4qj">String(200)</td>
			<td class="tg-wo29">http://xxx.com/notify.htm</td>
			<td class="tg-wo29">支付结果回调URL</td>
		  </tr>
		  <tr>
			<td class="tg-855q">商品主题</td>
			<td class="tg-855q">subject</td>
			<td class="tg-855q">是</td>
			<td class="tg-855q">String(64)</td>
			<td class="tg-855q">测试商品</td>
			<td class="tg-855q">商品主题</td>
		  </tr>
		  <tr>
			<td class="tg-u4qj">商品描述信息</td>
			<td class="tg-u4qj">body</td>
			<td class="tg-u4qj">是</td>
			<td class="tg-u4qj">String(256)</td>
			<td class="tg-wo29">xxpay测试商品描述</td>
			<td class="tg-wo29">商品描述信息</td>
		  </tr>
		  <tr>
			<td class="tg-855q">扩展参数1</td>
			<td class="tg-855q">param1</td>
			<td class="tg-855q">否</td>
			<td class="tg-855q">String(64)</td>
			<td class="tg-855q"></td>
			<td class="tg-855q">支付中心回调时会原样返回</td>
		  </tr>
		  <tr>
			<td class="tg-wo29">扩展参数2</td>
			<td class="tg-wo29">param2</td>
			<td class="tg-wo29">否</td>
			<td class="tg-wo29">String(64)</td>
			<td class="tg-wo29"></td>
			<td class="tg-wo29">支付中心回调时会原样返回</td>
		  </tr>
		  <tr>
			<td class="tg-855q">附加参数</td>
			<td class="tg-855q">extra</td>
			<td class="tg-855q">是</td>
			<td class="tg-855q">String(512)</td>
			<td class="tg-855q">{“openId”:”o2RvowBf7sOVJf8kJksUEMceaDqo”}</td>
			<td class="tg-855q">特定渠道发起时额外参数,见下面说明</td>
		  </tr>
		  <tr>
			<td class="tg-wo29">签名</td>
			<td class="tg-wo29">sign</td>
			<td class="tg-wo29">是</td>
			<td class="tg-wo29">String(32)</td>
			<td class="tg-wo29">C380BEC2BFD727A4B6845133519F3AD6</td>
			<td class="tg-wo29">签名值，详见签名算法</td>
		  </tr>
		</table>
	<div class="doc-title-box">
			<h2 style="font-weight: bold;">参数示例</h2>
	</div>
	<p><pre>
	params={"amount":1,"mchId":"10000000","mchOrderNo":"9af01329f1ec4c4694631b077a0e8573","subject":"商品支付主题","sign":"F64C43C1487C7C0DA93DA93DD2961FA2","body":"商品支付内容","param1":"","param2":"","clientIp":"127.0.0.1","extra":"{\"openId\":\"osirq1MMdgrCw7ohNNV6JhwvDFO8\"}","notifyUrl":"http://ngrok.4jicao.com/goods/payNotify","currency":"CAD","device":"WEB","channelId":"WX_JSAPI"}
	</pre>
	</p>
	<div class="doc-title-box">
			<h2 style="font-weight: bold;">extra参数说明</h2>
	</div>
	<p>1 当请求参数channelId = WX_JSAPI（微信公众号支付）时，openId参数必填，对应用户所在微信公众号的openId。</p>
	<p><pre>{"openId":"o2RvowBf7sOVJf8kJksUEMceaDqo","isNeedSubAppId":1}</pre></p>
	<p>2 当请求参数channelId = WX_MWEB（微信H5/APP支付）时，sceneInfo参数必填。参考值：</p>
	<p>◆ IOS移动应用</p>
	<p>{“h5_info”: //h5支付固定传”h5_info” {“type”: “”, //场景类型”app_name”: “”, //应用名”bundle_id”: “” //bundle_id}}</p>
	<p>◆ 安卓移动应用</p>
	<p>{“h5_info”: //h5支付固定传”h5_info” {“type”: “”, //场景类型”app_name”:””,//应用名 “package_name”: “” //包名 }}</p>
	<p>◆ WAP网站应用</p>
	<p>{“h5_info”: //h5支付固定传”h5_info”{“type”: “”, //场景类型 “wap_url”:””,//WAP网站URL地址”wap_name”: “” //WAP 网站名 }}</p>
	<p><pre>{"sceneInfo":"{\"h5_info\": \"h5_info\"  {\"type\": \"\",  \"wap_url\": \"\", \"wap_name\": \"\"}}"}</pre></p>
	
	<p>3 当请求参数channelId = WX_NATIVE （微信原生扫码支付）时，productId参数必填，对应业务系统定义的商品ID。</p>
	<p><pre>{"productId":"120989823"}</pre></p>
	</section>
	</div>
	
	<script src="js/jquery-2.1.1.min.js" type="text/javascript"></script>
	<script>
	$('.openNav').click(function () {
	    $('body').toggleClass('navOpen');
	    $('nav').toggleClass('open');
	    $('.wrapper').toggleClass('open');
	    $(this).toggleClass('open');
	});
	</script>
</body>
</html>